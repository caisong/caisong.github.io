<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>运维 on Caisong's Blog</title><link>https://caisong.github.io/categories/%E8%BF%90%E7%BB%B4/</link><description>Recent content in 运维 on Caisong's Blog</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Fri, 27 Dec 2024 21:40:34 +0800</lastBuildDate><atom:link href="https://caisong.github.io/categories/%E8%BF%90%E7%BB%B4/index.xml" rel="self" type="application/rss+xml"/><item><title>Centos更新rsyslog</title><link>https://caisong.github.io/posts/centos%E6%9B%B4%E6%96%B0rsyslog/</link><pubDate>Fri, 27 Dec 2024 21:40:34 +0800</pubDate><guid>https://caisong.github.io/posts/centos%E6%9B%B4%E6%96%B0rsyslog/</guid><description>&lt;p>centos 7 默认不携带mmnormlize这个module,需要额外安装&lt;/p></description></item><item><title>Apache webdav配置</title><link>https://caisong.github.io/posts/apachewebdav%E9%85%8D%E7%BD%AE/</link><pubDate>Tue, 24 Dec 2024 21:40:28 +0800</pubDate><guid>https://caisong.github.io/posts/apachewebdav%E9%85%8D%E7%BD%AE/</guid><description>&lt;p>apache webdav配置&lt;/p></description></item><item><title>Kill zombie</title><link>https://caisong.github.io/posts/killzombie/</link><pubDate>Wed, 09 Oct 2024 21:41:03 +0800</pubDate><guid>https://caisong.github.io/posts/killzombie/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ps -A -o stat,ppid,pid,cmd | grep -e &lt;span style="color:#e6db74">&amp;#39;^[Zz]&amp;#39;&lt;/span> | awk &lt;span style="color:#e6db74">&amp;#39;{print $2}&amp;#39;&lt;/span> | xargs kill -9
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Alpine vsftp搭建</title><link>https://caisong.github.io/posts/alpinevsftp%E6%90%AD%E5%BB%BA/</link><pubDate>Thu, 18 Jul 2024 21:42:06 +0800</pubDate><guid>https://caisong.github.io/posts/alpinevsftp%E6%90%AD%E5%BB%BA/</guid><description>&lt;p>alpine 搭建 vsftp 配置&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">anonymous_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">dirmessage_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">xferlog_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">connect_from_port_20&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">listen&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">local_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">chroot_local_user&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">allow_writeable_chroot&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">background&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">ftpd_banner&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">Welcome to FTP Server&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">dirmessage_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">max_clients&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">10&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">max_per_ip&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">5&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">write_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">local_umask&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">022&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">passwd_chroot_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">listen_ipv6&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">seccomp_sandbox&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">log_ftp_protocol&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">xferlog_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">xferlog_std_format&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">NO&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">dual_log_enable&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">YES&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">xferlog_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/var/log/vsftpd/xferlog.log&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">vsftpd_log_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/var/log/vsftpd/vsftpd.log&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>创建用户&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>addgroup -S ftpuser
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>adduser -D -G ftpuser -h /home/vsftpd/ftpuser -s /bin/false ftpuser
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir -p /home/vsftpd/ftpuser
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chown -R ftpuser:ftpuser /home/vs
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$FTP_USER&lt;span style="color:#e6db74">:&lt;/span>$FTP_PASS&lt;span style="color:#e6db74">&amp;#34;&lt;/span> | /usr/sbin/chpasswd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>启动服务&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>rc-service vsftpd start
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>运维管理分发</title><link>https://caisong.github.io/posts/%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86%E5%88%86%E5%8F%91/</link><pubDate>Mon, 03 Jun 2024 21:41:53 +0800</pubDate><guid>https://caisong.github.io/posts/%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86%E5%88%86%E5%8F%91/</guid><description>&lt;p>运维分发工具,记录下。后期使用了再补充。&lt;/p></description></item><item><title>运维接口</title><link>https://caisong.github.io/posts/%E8%BF%90%E7%BB%B4%E6%8E%A5%E5%8F%A3/</link><pubDate>Sun, 22 Oct 2023 21:41:54 +0800</pubDate><guid>https://caisong.github.io/posts/%E8%BF%90%E7%BB%B4%E6%8E%A5%E5%8F%A3/</guid><description>&lt;p>考虑如何上报运维数据，未落地方案&lt;/p></description></item><item><title>L2TP部署</title><link>https://caisong.github.io/posts/l2tp/</link><pubDate>Wed, 28 Sep 2022 21:41:05 +0800</pubDate><guid>https://caisong.github.io/posts/l2tp/</guid><description>&lt;h2 id="l2tp服务端">L2TP服务端&lt;/h2>
&lt;ol>
&lt;li>内核加载&lt;code>modprobe af_key&lt;/code>&lt;/li>
&lt;li>配置文件&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>cat &amp;gt; vpn.env &lt;span style="color:#e6db74">&amp;lt;&amp;lt; EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">VPN_IPSEC_PSK=random
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">VPN_USER=caisong
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">VPN_PASSWORD=123456
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>l2tp容器&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 容器内通信，不需要对外连接&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run --name l2tp-vpn-server --env-file ./vpn.env -p 500:500/udp -p 4500:4500/udp -v /lib/modules:/lib/modules:ro -d --privileged hwdsl2/ipsec-vpn-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="l2tp客户端">L2TP客户端&lt;/h2>
&lt;ol>
&lt;li>centos基础镜像&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 必须挂载module，容器里没有&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run -itd -v /lib/modules:/lib/modules:ro --privileged centos:8 /sbin/init
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>客户端配置&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 容器镜像不带这些module，安装软件会有依赖。直接先把依赖的module安装完成后，再这个镜像基础上再安装l2tp客户端&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dnf install xl2tpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VPN_SERVER_IP&lt;span style="color:#f92672">=&lt;/span>random 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VPN_IPSEC_PSK&lt;span style="color:#f92672">=&lt;/span>172.17.0.2 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VPN_USERNAME&lt;span style="color:#f92672">=&lt;/span>caisong
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VPN_PASSWORD&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">123456&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>/etc/xl2tpd/xl2tpd.conf&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>cat &amp;gt; /etc/xl2tpd/xl2tpd.conf &lt;span style="color:#e6db74">&amp;lt;&amp;lt;EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">[lac myvpn]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">lns = $VPN_SERVER_IP
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">ppp debug = yes
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">pppoptfile = /etc/ppp/options.l2tpd.client
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">length bit = yes
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>/etc/ppp/options.l2tpd.client&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>cat &amp;gt; /etc/ppp/options.l2tpd.client &lt;span style="color:#e6db74">&amp;lt;&amp;lt;EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">ipcp-accept-local
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">ipcp-accept-remote
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">refuse-eap
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">require-chap
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">noccp
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">noauth
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">mtu 1280
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">mru 1280
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">noipdefault
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">defaultroute
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">usepeerdns
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">connect-delay 5000
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">name $VPN_USER
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">password $VPN_PASSWORD
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Create xl2tpd control file:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>mkdir -p /var/run/xl2tpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>touch /var/run/xl2tpd/l2tp-control
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl start xl2tpd 
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Kafaka消费组管理</title><link>https://caisong.github.io/posts/kafaka%E6%B6%88%E8%B4%B9%E7%BB%84%E7%AE%A1%E7%90%86/</link><pubDate>Wed, 31 Aug 2022 21:41:03 +0800</pubDate><guid>https://caisong.github.io/posts/kafaka%E6%B6%88%E8%B4%B9%E7%BB%84%E7%AE%A1%E7%90%86/</guid><description>&lt;p>Cut out summary from your post content here.&lt;/p></description></item><item><title>自签HTTPS证书</title><link>https://caisong.github.io/posts/https%E8%AF%81%E4%B9%A6/</link><pubDate>Tue, 30 Aug 2022 21:40:59 +0800</pubDate><guid>https://caisong.github.io/posts/https%E8%AF%81%E4%B9%A6/</guid><description>&lt;h1 id="https证书">HTTPS证书&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>sudo openssl req -x509 -nodes -days &lt;span style="color:#ae81ff">365&lt;/span> -newkey rsa:2048 -keyout /etc/ssl/private/nginx-selfsigned.key -out /etc/ssl/certs/nginx-selfsigned.crt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Alpinek8s安装</title><link>https://caisong.github.io/posts/alpinek8s%E5%AE%89%E8%A3%85/</link><pubDate>Thu, 17 Mar 2022 21:40:27 +0800</pubDate><guid>https://caisong.github.io/posts/alpinek8s%E5%AE%89%E8%A3%85/</guid><description>&lt;h2 id="alpine-k8s安装">alpine k8s安装&lt;/h2>
&lt;p>&lt;a href="https://dev.to/xphoniex/how-to-create-a-kubernetes-cluster-on-alpine-linux-kcg">安装参考&lt;/a>&lt;/p>
&lt;h3 id="配置vagrant">配置vagrant&lt;/h3>
&lt;p>略&lt;/p>
&lt;h3 id="master节点安装">master节点安装&lt;/h3>
&lt;ol>
&lt;li>添加edge软件源&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>https://mirrors.ustc.edu.cn/alpine/latest-stable/main
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>https://mirrors.ustc.edu.cn/alpine/latest-stable/community
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>@testing http://mirrors.ustc.edu.cn/alpine/edge/testing
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>@community http://mirrors.ustc.edu.cn/alpine/edge/community
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>apk更新后，重启，否则docker启动失败，报iptables相关错误&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 重启后失败再尝试以下命令&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo modprobe ip_tables
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo echo &lt;span style="color:#e6db74">&amp;#39;ip_tables&amp;#39;&lt;/span> &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>安装软件包&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># mater节点&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add kubernetes@testing
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add docker@community
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add cni-plugins@testing
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add kubelet@testing
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># node节点&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add docker@community
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apk add kubelet@testing
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>kubeadm init 的时候指定镜像源&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 先查看IP和kubernetes的版本&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kubeadm version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># init的时候指定registry源&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo kubeadm init --kubernetes-version&lt;span style="color:#f92672">=&lt;/span>v1.23.4 --image-repository registry.aliyuncs.com/google_containers --apiserver-advertise-address&lt;span style="color:#f92672">=&lt;/span>192.168.33.10
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>记录命令执行后返回的结果&lt;/p></description></item><item><title>Alpine无法使用minikube，具体原因未知</title><link>https://caisong.github.io/posts/alpine%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8minikube%E5%85%B7%E4%BD%93%E5%8E%9F%E5%9B%A0%E6%9C%AA%E7%9F%A5/</link><pubDate>Tue, 21 Dec 2021 21:42:07 +0800</pubDate><guid>https://caisong.github.io/posts/alpine%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8minikube%E5%85%B7%E4%BD%93%E5%8E%9F%E5%9B%A0%E6%9C%AA%E7%9F%A5/</guid><description>&lt;p>使用alpine镜像构建ks8 minikube集群&lt;/p></description></item><item><title>python远程控制 自动化部署</title><link>https://caisong.github.io/posts/fabric%E8%BD%BB%E9%87%8F%E8%BF%9C%E7%AB%AF%E9%83%A8%E7%BD%B2/</link><pubDate>Fri, 03 Sep 2021 21:42:11 +0800</pubDate><guid>https://caisong.github.io/posts/fabric%E8%BD%BB%E9%87%8F%E8%BF%9C%E7%AB%AF%E9%83%A8%E7%BD%B2/</guid><description>&lt;ul>
&lt;li>fabric：轻量远端部署&lt;/li>
&lt;li>ShutIt：基于python的expect库&lt;/li>
&lt;li>Ansible：自动化部署&lt;/li>
&lt;li>saltstack：自动化部署&lt;/li>
&lt;li>Puppet：自动化配置管理工具（Ruby）&lt;/li>
&lt;/ul></description></item><item><title>Ipv6地址设定</title><link>https://caisong.github.io/posts/ipv6%E5%9C%B0%E5%9D%80%E8%AE%BE%E5%AE%9A/</link><pubDate>Fri, 03 Sep 2021 21:41:59 +0800</pubDate><guid>https://caisong.github.io/posts/ipv6%E5%9C%B0%E5%9D%80%E8%AE%BE%E5%AE%9A/</guid><description>&lt;p>Cut out summary from your post content here.&lt;/p></description></item><item><title>Minikube 部署</title><link>https://caisong.github.io/posts/minikube/</link><pubDate>Fri, 03 Sep 2021 21:41:11 +0800</pubDate><guid>https://caisong.github.io/posts/minikube/</guid><description>&lt;h1 id="minikube">minikube&lt;/h1>
&lt;p>&lt;a href="https://github.com/AliyunContainerService/minikube">https://github.com/AliyunContainerService/minikube&lt;/a>
&lt;a href="https://developer.aliyun.com/article/221687">https://developer.aliyun.com/article/221687&lt;/a>
&lt;a href="https://blog.csdn.net/wchbest/article/details/88873965">https://blog.csdn.net/wchbest/article/details/88873965&lt;/a>
&lt;a href="https://minikube.sigs.k8s.io/docs/start/">https://minikube.sigs.k8s.io/docs/start/&lt;/a>
&lt;a href="https://www.jianshu.com/p/a42eeb66a19c">https://www.jianshu.com/p/a42eeb66a19c&lt;/a>
&lt;a href="https://www.cnblogs.com/kazihuo/p/10184286.html">https://www.cnblogs.com/kazihuo/p/10184286.html&lt;/a>&lt;/p></description></item><item><title>Iptables 记录</title><link>https://caisong.github.io/posts/iptables/</link><pubDate>Fri, 03 Sep 2021 21:41:02 +0800</pubDate><guid>https://caisong.github.io/posts/iptables/</guid><description>&lt;p>The &lt;code>iptables&lt;/code> command will attempt a reverse lookup on ip addresses. This will produce exactly the behavior you describe. You can inhibit the reverse lookup with the -n flag, which is why I always list rules like this:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>iptables -vnL
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This fact and many other useful tidbits can be found in the &lt;code>iptables&lt;/code> man page. The relevant section concerning &lt;code>-n&lt;/code> reads:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>-L, --list &lt;span style="color:#f92672">[&lt;/span>chain&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>List all rules in the selected chain. If no chain is selected, all chains
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>are listed. Like every other iptables command, it applies to the specified
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>table &lt;span style="color:#f92672">(&lt;/span>filter is the default&lt;span style="color:#f92672">)&lt;/span>, so NAT rules get listed by
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> iptables -t nat -n -L
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Please note that it is often used with the -n option, in order to avoid
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>long reverse DNS lookups. It is legal to specify the -Z &lt;span style="color:#f92672">(&lt;/span>zero&lt;span style="color:#f92672">)&lt;/span> option as
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>well, in which &lt;span style="color:#66d9ef">case&lt;/span> the chain&lt;span style="color:#f92672">(&lt;/span>s&lt;span style="color:#f92672">)&lt;/span> will be atomically listed and zeroed. The
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>exact output is affected by the other arguments given. The exact rules are
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>suppressed &lt;span style="color:#66d9ef">until&lt;/span> you use
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> iptables -L -v
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Tags:
iptables&lt;/p></description></item><item><title>Disable disk cache</title><link>https://caisong.github.io/posts/disablediskcache/</link><pubDate>Fri, 03 Sep 2021 21:40:38 +0800</pubDate><guid>https://caisong.github.io/posts/disablediskcache/</guid><description>&lt;p>disable disk cache&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>hdparm -W &lt;span style="color:#ae81ff">0&lt;/span> /dev/sda1 &lt;span style="color:#75715e">#disable&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hdparm -W &lt;span style="color:#ae81ff">1&lt;/span> /dev/sda1 &lt;span style="color:#75715e">#enable&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>django部署apache2</title><link>https://caisong.github.io/posts/apache/</link><pubDate>Sun, 01 Apr 2018 20:55:39 +0000</pubDate><guid>https://caisong.github.io/posts/apache/</guid><description>&lt;p>最近学习使用django，尝试部署至apache2。&lt;/p>
&lt;ol>
&lt;li>required env&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt-get install apache2 libapache2-mod-wsgi-py3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo pip install django
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>
&lt;p>拷贝目录至&lt;code>/var/www&lt;/code>(apache2的默认网站目录)，之前未拷贝，在其他目录尝试了几次都未成功。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>添加配置website&lt;/p>
&lt;ol>
&lt;li>
&lt;p>配置网站配置&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd /etc/apache2/sites-avaliable/ &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> cp 000-default.conf yoursite.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>配置详情&lt;/p>
&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;VirtualHost&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">*:80&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	ServerName 127.0.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	ServerAdmin webmaster@localhost
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	# 网站根目录, 请根据自身目录配置，下同
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	DocumentRoot /var/www/web
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	#静态文件目录
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	Alias /static/ /var/www/web/static/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;Directory&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">/var/www/web/static&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		Require all granted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;/Directory&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	WSGIScriptAlias / /var/www/web/web/wsgi.py
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;Directory&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">/var/www/web/web&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;Files&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">wsgi.py&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		Require all granted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;/Files&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">&amp;lt;/Directory&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;/VirtualHost&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>查看django wigi.py文件
默认生成的文件没有问题，不需要修改即可运行。&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> os.path &lt;span style="color:#f92672">import&lt;/span> join, dirname,abspath
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> django.core.wsgi &lt;span style="color:#f92672">import&lt;/span> get_wsgi_application
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PROJECT_DIR &lt;span style="color:#f92672">=&lt;/span> dirname(dirname(abspath(__file__)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> sys
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sys&lt;span style="color:#f92672">.&lt;/span>path&lt;span style="color:#f92672">.&lt;/span>insert(&lt;span style="color:#ae81ff">0&lt;/span>, PROJECT_DIR)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>os&lt;span style="color:#f92672">.&lt;/span>environ&lt;span style="color:#f92672">.&lt;/span>setdefault(&lt;span style="color:#e6db74">&amp;#34;DJANGO_SETTINGS_MODULE&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;web.settings&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>application &lt;span style="color:#f92672">=&lt;/span> get_wsgi_application()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>配置django环境
进入你的网站根目录&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#static files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#前提在你的setting.py文件中设置好STATIC_ROOT目录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>python manage.py collectstatic
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>python manage.py migrate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="5">
&lt;li>修改目录权限为&lt;code>www-data&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo chown www-data:www-data webroot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 如果存在数据库，请同时修改相应权限&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="6">
&lt;li>使网站生效&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>	sudo a2ensite yoursite.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	service apache2 reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></description></item></channel></rss>